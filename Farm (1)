task.wait(10)
local Players = game:GetService("Players")
local RS = game:GetService("ReplicatedStorage")
local UIS = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local player = Players.LocalPlayer

-- // CONFIGURATION // --
getgenv().AutoRadioactive = true
local RequiredMinutes = 60 -- Change this to how many minutes you want to wait for
local waitTime = 30        -- Cooldown (in seconds) after finishing all machines
local skipWait = false
local targetPosSpawn = Vector3.new(906, 3, 10)
local MAX_SCALE_THRESHOLD = 2.99 

-- // PRIORITAS ITEM & MUTASI // --
local PriorityConfig = {
    {
        Name = "Rubichetto Cubini",
        Mutations = {"Lucky", "Money", "UFO","Radioactive", "Emerald", "None"}
    },
    {
        Name = "Freezeti Cobretti",
        Mutations = {"Lucky", "Money", "UFO","Radioactive", "Emerald", "None"}
    },
    {
        Name = "Glacierello Infernetti",
        Mutations = {"Lucky", "Money", "UFO","Radioactive", "Emerald", "None"}
    },
    {
        Name = "Galactio Fantasma",
        Mutations = {"Lucky", "Money", "UFO", "Radioactive", "None"}
    },
    {
        Name = "Din Din Vaultero",
        Mutations = {"Lucky", "Money", "UFO", "Radioactive", "None"}
    },
    {
        Name = "Strawberry Elephant",
        Mutations = {"Lucky", "Money", "UFO", "Radioactive", "None"}
    },
    {
        Name = "Bulbito Bandito Traktorito",
        Mutations = {"Lucky", "Money", "UFO", "Radioactive", "None"}
    },
    {
        Name = "Burgerini Bearini",
        Mutations = {"Lucky", "Money", "UFO", "Radioactive", "None"}
    },
    {
        Name = "Martino Gravitino",
        Mutations = {"Lucky", "Money", "UFO", "Radioactive", "None"}
    }
}

local spawnRemote = RS:WaitForChild("Packages"):WaitForChild("Net"):WaitForChild("RF/SpawnMachine.Action")

-- // UI STATUS // --
local sg = game:GetService("CoreGui"):FindFirstChild("GalactioSoloUI") or Instance.new("ScreenGui", game:GetService("CoreGui"))
sg.Name = "GalactioSoloUI"
if sg:FindFirstChild("StatusFrame") then sg.StatusFrame:Destroy() end

local function createUI()
    local f = Instance.new("Frame", sg)
    f.Name = "StatusFrame"
    f.Size = UDim2.new(0, 250, 0, 100)
    f.Position = UDim2.new(0.8, 0, 0.2, 0)
    f.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    Instance.new("UICorner", f)
 
    local statusLabel = Instance.new("TextLabel", f)
    statusLabel.Size = UDim2.new(1, 0, 1, 0)
    statusLabel.BackgroundTransparency = 1
    statusLabel.TextColor3 = Color3.new(1, 1, 1)
    statusLabel.Font = Enum.Font.GothamBold
    statusLabel.TextScaled = true
    statusLabel.Text = "Initializing..."
    return statusLabel
end

local UI_Status = createUI()

local function setStatus(msg)
    if UI_Status then UI_Status.Text = msg end
end

-- // UTILITIES // --
local function getToolInfo(tool)
    return {
        Name = tool:GetAttribute("BrainrotName") or tool.Name,
        Mutation = tostring(tool:GetAttribute("Mutation") or "None"),
        Scale = tonumber(tool:GetAttribute("Scale")) or 1
    }
end

local function findBestItem()
    local items = player.Backpack:GetChildren()

    for _, config in ipairs(PriorityConfig) do
        local currentCategoryItems = {}
        
        for _, v in pairs(items) do
            local info = getToolInfo(v)
            if string.find(info.Name, config.Name) then
                table.insert(currentCategoryItems, v)
            end
        end

        if #currentCategoryItems > 0 then
            local moneyHigh = {}
            for _, v in ipairs(currentCategoryItems) do
                local info = getToolInfo(v)
                if info.Mutation == "Money" and info.Scale >= 2 and info.Scale <= MAX_SCALE_THRESHOLD then
                    table.insert(moneyHigh, v)
                end
            end
            if #moneyHigh > 0 then
                table.sort(moneyHigh, function(a, b) return getToolInfo(a).Scale > getToolInfo(b).Scale end)
                return moneyHigh[1]
            end

            local highScale = {}
            for _, v in ipairs(currentCategoryItems) do
                local info = getToolInfo(v)
                if info.Scale >= 2 and info.Scale < MAX_SCALE_THRESHOLD then
                    table.insert(highScale, v)
                end
            end
            if #highScale > 0 then
                table.sort(highScale, function(a, b) return getToolInfo(a).Scale > getToolInfo(b).Scale end)
                return highScale[1]
            end

            local extremeScale = {}
            for _, v in ipairs(currentCategoryItems) do
                local info = getToolInfo(v)
                if info.Scale >= MAX_SCALE_THRESHOLD then
                    table.insert(extremeScale, v)
                end
            end
            if #extremeScale > 0 then
                table.sort(extremeScale, function(a, b) return getToolInfo(a).Scale > getToolInfo(b).Scale end)
                return extremeScale[1]
            end

            table.sort(currentCategoryItems, function(a, b) return getToolInfo(a).Scale > getToolInfo(b).Scale end)
            return currentCategoryItems[1]
        end
    end
    return nil
end

local function runSafePath()
    local char = player.Character or player.CharacterAdded:Wait()
    local hrp = char:WaitForChild("HumanoidRootPart")
    for _, part in ipairs(char:GetDescendants()) do
        if part:IsA("BasePart") then part.CanCollide = false end
    end
    local positions = {
        Vector3.new(128, 3, -136),
        Vector3.new(113, 43, -140),
        Vector3.new(753, 34, -139),
        Vector3.new(758, -3, -134),
        Vector3.new(758, -3, 21)
    }
    for _, pos in ipairs(positions) do
        local tween = TweenService:Create(hrp, TweenInfo.new(0.3, Enum.EasingStyle.Linear), {CFrame = CFrame.new(pos)})
        tween:Play()
        tween.Completed:Wait()
    end
end

-- // CORE LOGIC // --
local function startMainLoop()
    setStatus("Threshold Reached! Starting...")
    task.wait(2)
    while true do
        if getgenv().AutoRadioactive then
            local target = findBestItem()
            if target then
                local machineNames = {"ATM", "Arcade", "Blackhole"}
                local spawnMachinesFolder = workspace:FindFirstChild("SpawnMachines")
             
                if spawnMachinesFolder then
                    local availableMachines = {}
                    for _, mName in ipairs(machineNames) do
                        local m = spawnMachinesFolder:FindFirstChild(mName)
                        if m then table.insert(availableMachines, m) end
                    end

                    for i, currentMachine in ipairs(availableMachines) do
                        if not getgenv().AutoRadioactive then break end
                        
                        local char = player.Character or player.CharacterAdded:Wait()
                        local root = char:WaitForChild("HumanoidRootPart")
                        local hum = char:WaitForChild("Humanoid")
                        
                        local info = getToolInfo(target)
                        setStatus("Using: " .. info.Name .. " on " .. currentMachine.Name)
                        runSafePath()
                            
                        local isProcessing = true
                        local tpLoop = task.spawn(function()
                            while isProcessing do
                                if root then root.CFrame = CFrame.new(targetPosSpawn) end
                                task.wait(0.1)
                            end
                        end)

                        hum:EquipTool(target)
                        task.wait(0.3)

                        spawnRemote:InvokeServer("Deposit", currentMachine)
                        task.wait(0.2)
                        spawnRemote:InvokeServer("Combine", currentMachine)
                        task.wait(0.2)
                        spawnRemote:InvokeServer("Withdraw", currentMachine)
                        task.wait(0.2)

                        isProcessing = false
                        task.cancel(tpLoop)

                        if #availableMachines > 1 and i < #availableMachines then
                            setStatus("Resetting... Waiting 5s")
                            char:BreakJoints()
                            task.wait(5)
                            player.CharacterAdded:Wait()
                            task.wait(1)
                            target = findBestItem()
                            if not target then break end
                        end
                    end
                end
                setStatus("Cycle Done!")
            else
                setStatus("Inventory Empty / No Matches!")
            end
            
            local timer = waitTime
            skipWait = false
            while timer > 0 and not skipWait and getgenv().AutoRadioactive do
                setStatus("Cooldown: " .. timer .. "s")
                task.wait(1)
                timer = timer - 1
            end
        else
            setStatus("PAUSED")
            task.wait(2)
        end
    end
end

UIS.InputBegan:Connect(function(input, gp)
    if gp then return end
    if input.KeyCode == Enum.KeyCode.P then
        skipWait = true
    elseif input.KeyCode == Enum.KeyCode.LeftBracket then
        getgenv().AutoRadioactive = not getgenv().AutoRadioactive
    end
end)

-- // LOOPED TIMER CHECK // --
local function waitForTimerAndStart()
    local requiredSeconds = RequiredMinutes * 60
    setStatus("Waiting for Timer > " .. RequiredMinutes .. "m")
    
    while true do
        local success, timerLabel = pcall(function()
            return workspace.SpawnMachines.Default.Main.Billboard.BillboardGui.Frame.Brainrots.AFKLuckContainer.TimeLabel
        end)

        if success and timerLabel then
            local text = timerLabel.Text 
            local min, sec = text:match("(%d+):(%d+)")
            
            if min and sec then
                local currentSeconds = (tonumber(min) * 60) + tonumber(sec)
                
                if currentSeconds >= requiredSeconds then
                    setStatus("Timer OK ("..text..")! Launching...")
                    break 
                else
                    setStatus("Wait: " .. text .. " (Need "..RequiredMinutes.."m)")
                end
            else
                setStatus("Parsing Error: " .. text)
            end
        else
            setStatus("Searching for Timer...")
        end
        
        task.wait(2)
    end

    startMainLoop()
end

task.spawn(waitForTimerAndStart)
